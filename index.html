<!DOCTYPE html>
<html>
<head>
    <title>Дзынь</title>

    <!-- Мета-теги для иконок и цветовой схемы -->
    <link rel="apple-touch-icon" sizes="192x192" href="dzin.png">
    
    <!-- Мета-теги для Windows и цветовой схемы -->
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- Мета-теги для iOS PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <!-- Стиль для фонового изображения и полноэкранного режима -->
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }

        body {
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
        }
    </style>
</head>
<body>
    <script>
        // Диплинк
        var vkUrl = "vk://vk.com/write-218837624?mvk_entrypoint=community_page";
        var webUrl = "https://m.vk.com/write-218837624?mvk_entrypoint=community_page";

        // Функция для проверки, поддерживается ли URI-схема VK
        function checkVkSupport() {
     // Создайте временный элемент для выполнения AJAX-запроса
        var ajaxTestElement = document.createElement("iframe");
        ajaxTestElement.style.display = "none";
        document.body.appendChild(ajaxTestElement);

        // Попробуйте выполнить запрос на URL-схему VK
        ajaxTestElement.src = vkUrl;

        // Ожидайте некоторое время и проверьте, открылась ли URL-схема VK
        setTimeout(function() {
            // Если URL-схема доступна (iframe загрузился), перенаправьте пользователя на приложение VK
            if (!ajaxTestElement.contentWindow) {
                // URL-схема недоступна, перенаправьте пользователя на веб-версию
                window.location.href = webUrl;
            } else {
                // URL-схема доступна, перенаправьте пользователя на приложение VK
                window.location.href = vkUrl;
            }

            // Удалите временный элемент
            document.body.removeChild(ajaxTestElement);
        }, 1000); // Вы можете увеличить или уменьшить задержку в миллисекундах, в зависимости от вашего опыта тестирования
        }

     if (window.navigator.standalone) {
        checkVkSupport();
    }

        // Обработчик события visibilitychange
        document.addEventListener('visibilitychange', function () {
            if (document.visibilityState === 'visible' && window.navigator.standalone) {
                // Вызываем функцию проверки поддержки URI-схемы VK при разворачивании
                checkVkSupport();
            }
        });
    </script>
</body>
</html>
