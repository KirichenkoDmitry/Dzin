<!DOCTYPE html>
<html>
<head>
    <title>Дзынь</title>

    <!-- Мета-теги для иконок и цветовой схемы -->
    <link rel="apple-touch-icon" sizes="192x192" href="dzin.png">
    
    <!-- Мета-теги для Windows и цветовой схемы -->
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- Мета-теги для iOS PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <!-- Стиль для фонового изображения и полноэкранного режима -->
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }

        body {
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
        }
    </style>
</head>
<body>
    <script>
        // Диплинк
        var vkUrl = "vk://vk.com/write-218837624?mvk_entrypoint=community_page";
        var webUrl = "https://m.vk.com/write-218837624?mvk_entrypoint=community_page";

        // Функция для проверки, поддерживается ли URI-схема VK
        function checkVkSupport() {
if ('getInstalledRelatedApps' in navigator) {
    navigator.getInstalledRelatedApps().then(function(apps) {
        for (var i = 0; i < apps.length; i++) {
            var app = apps[i];
            if (app.platform === 'play' && app.url.indexOf('vk.com') !== -1) {
                // Есть нативное приложение VK на устройстве
                window.location.href = vkUrl;
                return;
            }
        }
        // Нет нативного приложения VK, перенаправляем на веб-приложение
        window.location.href = webUrl;
    }).catch(function(error) {
        console.error('Ошибка при получении списка установленных приложений: ', error);
        // Если возникает ошибка, перенаправляем на веб-приложение
        window.location.href = webUrl;
    });
} else {
    // Метод `getInstalledRelatedApps` не поддерживается, перенаправляем на веб-приложение
    window.location.href = webUrl;
}

        }

     if (window.navigator.standalone) {
        checkVkSupport();
    }

        // Обработчик события visibilitychange
        document.addEventListener('visibilitychange', function () {
            if (document.visibilityState === 'visible' && window.navigator.standalone) {
                // Вызываем функцию проверки поддержки URI-схемы VK при разворачивании
                checkVkSupport();
            }
        });
    </script>
</body>
</html>
