<!DOCTYPE html>
<html>
<head>
    <title>Дзынь</title>

    <!-- Мета-теги для иконок и цветовой схемы -->
    <link rel="apple-touch-icon" sizes="192x192" href="dzin.png">
    
    <!-- Мета-теги для Windows и цветовой схемы -->
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- Мета-теги для iOS PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <!-- Стиль для фонового изображения и полноэкранного режима -->
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }

        body {
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
        }
    </style>
</head>
<body>
    <script>
        // диплинк
        var vkUrl = "vk://vk.com/write-218837624?mvk_entrypoint=community_page";
        var webUrl = "https://m.vk.com/write-218837624?mvk_entrypoint=community_page";

         // Функция для проверки, можно ли открыть ссылку с использованием "vk://"
        function canOpenVkLink() {
            var userAgent = window.navigator.userAgent.toLowerCase();
            if (userAgent.includes("android") || userAgent.includes("iphone")) {
                // Если пользователь на Android или iPhone, проверьте, есть ли приложение VK
                if (userAgent.includes("android")) {
                    if (window.Android && window.Android.canOpenURL(vkUrl)) {
                        window.location.href = vkUrl;
                    } else {
                        window.location.href = webUrl;
                    }
                } else if (userAgent.includes("iphone")) {
                    if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.canOpenURL) {
                        window.webkit.messageHandlers.canOpenURL.postMessage(vkUrl);
                        window.addEventListener("message", function(event) {
                            if (event.data === "true") {
                                window.location.href = vkUrl;
                            } else {
                                window.location.href = webUrl;
                            }
                        });
                    } else {
                        window.location.href = webUrl;
                    }
                }
            } else {
                window.location.href = webUrl;
            }
        }
        
        if (window.navigator.standalone) {
            // редирект на страницу VK
            canOpenVkLink();
        }

        // Обработчик события visibilitychange
        document.addEventListener('visibilitychange', function () {
            if (document.visibilityState === 'visible' && window.navigator.standalone) {
                // редирект на страницу VK при разворачивании
                canOpenVkLink();
            }
        });
    </script>
</body>
</html>

